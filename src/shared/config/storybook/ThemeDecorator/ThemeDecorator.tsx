// ThemeDecorator.tsx ‚Äî Storybook-–¥–µ–∫–æ—Ä–∞—Ç–æ—Ä –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Ç–µ–º—ã (light / dark) –∫ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º

import { Theme, ThemeProvider } from 'app/providers/ThemeProvider'; // ThemeProvider –Ω—É–∂–µ–Ω —Ç–µ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º –∫–æ—Ç–æ—ã–µ –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –µ–≥–æ –≤—ã–∑—ã–≤–∞—é—Ç –Ω–∞–ø—Ä–∏–µ—Ä ThemeSwitcher

import type { Decorator } from '@storybook/react';

/**
 * ThemeDecorator ‚Äî —Ñ–∞–±—Ä–∏–∫–∞-–¥–µ–∫–æ—Ä–∞—Ç–æ—Ä –¥–ª—è Storybook, –∫–æ—Ç–æ—Ä–∞—è –¥–æ–±–∞–≤–ª—è–µ—Ç —Ç–µ–º—É –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è (light/dark)
 * –∫ –∫–∞–∂–¥–æ–π –∏—Å—Ç–æ—Ä–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞.
 *
 * üîß –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–≤–∞ —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã:
 *
 * 1. –ì–ª–æ–±–∞–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ preview.ts:
 *    - –ö–æ–≥–¥–∞ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ `ThemeDecorator()` –±–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤,
 *    - –¢–µ–º–∞ –±–µ—Ä—ë—Ç—Å—è –∏–∑ –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ Storybook (`context.globals.theme`)
 *    - –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–µ–Ω—è—Ç—å —Ç–µ–º—É —á–µ—Ä–µ–∑ Toolbar (–≤–∫–ª–∞–¥–∫–∞ –Ω–∞–≤–µ—Ä—Ö—É Storybook UI)
 *
 * 2. –õ–æ–∫–∞–ª—å–Ω–æ–µ (–ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ) –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö stories:
 *    - –ö–æ–≥–¥–∞ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ `ThemeDecorator(Theme.DARK)` –∏–ª–∏ `Theme.LIGHT`,
 *    - –¢–µ–º–∞ –∑–∞–¥–∞—ë—Ç—Å—è —è–≤–Ω–æ –∏ –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –≤ Toolbar
 *    - –≠—Ç–æ —É–¥–æ–±–Ω–æ –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤, showcase-—Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –∏ —Ñ–∏–∫—Å–∞—Ü–∏–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ç–µ–º
 *
 * üìå –û–±–æ—Ä–∞—á–∏–≤–∞–µ—Ç –∫–∞–∂–¥—É—é story –≤ <div className="app [theme]">,
 *     —á—Ç–æ–±—ã –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Å—Ç–∏–ª–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ SCSS –∫–ª–∞—Å—Å—ã `.app.dark` / `.app.light`)
 *
 * üí° –ü–æ—á–µ–º—É —Å–¥–µ–ª–∞–Ω–æ –∫–∞–∫ —Ñ–∞–±—Ä–∏–∫–∞:
 *    - –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å: –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –≥–ª–æ–±–∞–ª—å–Ω–æ, —Ç–∞–∫ –∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ story
 *    - –°–Ω–∏–∂–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è: –Ω–µ –Ω—É–∂–Ω–æ –ø–∏—Å–∞—Ç—å –¥–≤–∞ —Ä–∞–∑–Ω—ã—Ö –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–∞
 *    - –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å –≥–ª–æ–±–∞–ª—å–Ω—ã–º —Ç—É–ª–±–∞—Ä–æ–º –∏ —Ä—É—á–Ω—ã–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º
 */
export const ThemeDecorator = (forcedTheme?: Theme): Decorator => {
    const Decorated: Decorator = (Story, context) => {
        // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ª–∏–±–æ –ø–µ—Ä–µ–¥–∞–Ω–Ω—É—é —Ç–µ–º—É, –ª–∏–±–æ —á–∏—Ç–∞–µ–º –∏–∑ –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ Storybook
        const theme = forcedTheme ?? (context.globals.theme as Theme);

        // –û–±–æ—Ä–∞—á–∏–≤–∞–µ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –≤ div —Å CSS-–∫–ª–∞—Å—Å–æ–º —Ç–µ–º—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä: .app.dark)
        return (
            <ThemeProvider initialTheme={theme}>
                <div className={`app ${theme}`}>{Story()}</div>
            </ThemeProvider>
        );
    };

    // –ü—Ä–∏—Å–≤–∞–∏–≤–∞–µ–º displayName –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –≤ React DevTools –∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –æ—à–∏–±–∫–∏ –ª–∏–Ω—Ç–µ—Ä–∞
    (Decorated as unknown as { displayName: string }).displayName = forcedTheme
        ? `ThemeDecorator(${forcedTheme})`
        : 'ThemeDecorator(dynamic)';

    return Decorated;
};
